<div class="qcm-container">
  <!-- Mode création -->
  <div *ngIf="!qcmId" class="creation-mode">
    <h2>Créer un nouveau QCM</h2>
    <textarea [(ngModel)]="codeSnippet" placeholder="Collez votre code Python ici..."></textarea>
    <button (click)="generateNewQcm()" [disabled]="isLoading">
      {{ isLoading ? 'Génération...' : 'Générer QCM' }}
    </button>
    <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>
  </div>

  <!-- Mode réponse -->
  <div *ngIf="qcmId && !isSubmitted" class="response-mode">
    <h2>Questionnaire</h2>

    <div class="student-info">
      <input [(ngModel)]="studentName" placeholder="Votre nom" required>
    </div>

    <div *ngFor="let question of questions; let i = index" class="question">
      <h3>{{ i + 1 }}. {{ question.question }}</h3>
      <div *ngFor="let choice of question.choices; let j = index" class="choice">
        <label>
          <input type="radio"
                 name="q{{i}}"
                 [value]="j"
                 (change)="selectAnswer(i, j.toString())">
          {{ choice }}
        </label>
      </div>
    </div>

    <button (click)="submitAnswers()" [disabled]="isLoading">
      {{ isLoading ? 'Envoi en cours...' : 'Soumettre' }}
    </button>
  </div>

  <!-- Confirmation -->
  <div *ngIf="isSubmitted" class="confirmation">
    <h2>Merci {{ studentName }} !</h2>
    <p>Vos réponses ont été enregistrées.</p>
    <p>Le professeur recevra une copie corrigée par email.</p>
  </div>
</div>
