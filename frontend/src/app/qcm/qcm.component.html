<div class="container" *ngIf="!isLoading; else loading">
  <h2>QCM : {{ author }} / {{ qcmId }}</h2>

  <div *ngIf="qcmData.length > 0; else noQcm">
    <form (ngSubmit)="submit()">
      <div *ngFor="let q of qcmData; let i = index" class="question-block">
        <p><strong>{{ i + 1 }}. {{ q.question }}</strong></p>
        <div *ngFor="let choice of q.choices">
          <label>
            <input
              type="radio"
              name="q{{ i }}"
              [value]="choice.charAt(0)"
              [(ngModel)]="answers[i]"
              required
            />
            {{ choice }}
          </label>
        </div>
      </div>
      <button type="submit">Soumettre</button>
    </form>

    <div *ngIf="feedback" class="feedback">{{ feedback }}</div>

    <button (click)="downloadPdf()">Télécharger PDF Professeur</button>
    <a *ngIf="pdfUrl" [href]="pdfUrl" target="_blank">Voir le PDF</a>
  </div>

  <ng-template #noQcm>
    <p>Aucun QCM à afficher pour {{ author }}/{{ qcmId }}.</p>
  </ng-template>
</div>

<ng-template #loading>
  <p>Chargement du QCM…</p>
</ng-template>
