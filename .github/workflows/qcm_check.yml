- name: üìù Cr√©er une Issue de rapport pour le professeur
  uses: actions/github-script@v6
  with:
    script: |
      const fs = require('fs');
      try {
        // V√©rifier si le fichier PDF existe
        const pdfExists = fs.existsSync('exo_etudiant.pdf');
        const pdfSize = pdfExists ? Math.round(fs.statSync('exo_etudiant.pdf').size / 1024) + ' Ko' : 'Fichier non trouv√©';

        // Cr√©er l'issue
        await github.rest.issues.create({
          owner: context.repo.owner,
          repo: context.repo.repo,
          title: `[Rapport] Nouveau QCM g√©n√©r√© - ${new Date().toLocaleDateString()}`,
          body: `Bonjour Professeur¬∑e,

Un nouveau QCM a √©t√© g√©n√©r√© avec succ√®s :

  - **Date**: ${new Date().toLocaleString()}
  - **Fichier PDF**: [exo_etudiant.pdf](https://github.com/${context.repo.owner}/${context.repo.repo}/actions/runs/${context.runId})
  - **Taille du PDF**: ${pdfSize}
  - **Lien direct vers l'art√©fact**: Voir les "Artifacts" dans l'onglet Actions

  Pouvez-vous v√©rifier le contenu et le valider ?

  Cordialement,
  Votre assistant de g√©n√©ration de QCM`,
labels: ['rapport', 'qcm']
});
  } catch (error) {
core.setFailed(`√âchec de la cr√©ation de l'issue: ${error}`);
}
